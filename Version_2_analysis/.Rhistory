source('~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Plotting_surv.R')
source('~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Plotting_surv.R')
source('~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Plotting_surv.R')
source('~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Plotting_surv.R')
source('~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Plotting_surv.R')
plot_all = ggsurvplot(fit,
pval = TRUE, conf.int = TRUE,
risk.table = FALSE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
linetype = "strata", # Change line type by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
palette = c("#E7B800", "#2E9FDF"))
print(plot_all)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Plotting_surv_Model_3_non_interaction.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/analytical_sample_vs_entire_sample.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/analytical_sample_vs_entire_sample.R")
participant_characteristics
race_participant_char
race_participant_char
nrow(data_race)/nrow(data_race)*100
nrow(data_race)
race = c(diabetes_throughout_the_study$race_white, non_diabetes_throughout_the_study$race_white)
data_ttest = cbind(case,
age,
race,
sex,
BMI,
#CVD,  n (%)
CVD,
#Hypertension, n (%)
hypertension,
#Depression, n (%)
depression,
#Alcohol consumption (days/week), Mean (SD)
#Alcohol_consumption,
#Smoker status, n (%)
Smoking_status,
MVPA,
wealth)
race_diff <- t_test(race ~ case, data = data_ttest)
data_ttest
data_ttest$race
data_ttest$age
data_ttest = as.data.frame(case,
age,
race,
sex,
BMI,
#CVD,  n (%)
CVD,
#Hypertension, n (%)
hypertension,
#Depression, n (%)
depression,
#Alcohol consumption (days/week), Mean (SD)
#Alcohol_consumption,
#Smoker status, n (%)
Smoking_status,
MVPA,
wealth)
data_ttest$case
data_ttest = data.frame(case,
age,
race,
sex,
BMI,
#CVD,  n (%)
CVD,
#Hypertension, n (%)
hypertension,
#Depression, n (%)
depression,
#Alcohol consumption (days/week), Mean (SD)
#Alcohol_consumption,
#Smoker status, n (%)
Smoking_status,
MVPA,
wealth)
data_ttest$race
race_diff <- t_test(race ~ case, data = data_ttest)
BMI_diff <- t_test(BMI ~ case, data = data_ttest)
age_diff <- t_test(age ~ case, data = data_ttest)
chisq.test(case, race)
chisq.test(case, sex)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/analytical_sample_vs_entire_sample.R")
chisq.test(case, sex)
chisq.test(data_ttest$case, data_ttest$race)
chisq.test(case, sex)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/analytical_sample_vs_entire_sample.R")
chisq.test(case, race)
chisq.test(case, race)
chisq.test(case, race)
case
diabetes_throughout_the_study$developed_diabetes = rep(1, times = nrow(diabetes_throughout_the_study))
non_diabetes_throughout_the_study$developed_diabetes = rep(0, times = nrow(non_diabetes_throughout_the_study))
case = c(diabetes_throughout_the_study$developed_diabete, non_diabetes_throughout_the_study$developed_diabetes)
case = c(diabetes_throughout_the_study$developed_diabete, non_diabetes_throughout_the_study$developed_diabetes)
unique(case)
case = c(diabetes_throughout_the_study$developed_diabetes, non_diabetes_throughout_the_study$developed_diabetes)
unique(case)
diabetes_throughout_the_study$developed_diabetes = rep(1, times = nrow(diabetes_throughout_the_study))
non_diabetes_throughout_the_study$developed_diabetes = rep(0, times = nrow(non_diabetes_throughout_the_study))
case = c(diabetes_throughout_the_study$developed_diabetes, non_diabetes_throughout_the_study$developed_diabetes)
unique(case)
diabetes_throughout_the_study$developed_diabetes = rep(1, times = nrow(diabetes_throughout_the_study))
non_diabetes_throughout_the_study$developed_diabetes = rep(0, times = nrow(non_diabetes_throughout_the_study))
case = c(diabetes_throughout_the_study$developed_diabetes, non_diabetes_throughout_the_study$developed_diabetes)
unique(case)
non_diabetes_throughout_the_study$developed_diabetes = rep(0, times = nrow(non_diabetes_throughout_the_study))
case = c(diabetes_throughout_the_study$developed_diabetes, non_diabetes_throughout_the_study$developed_diabetes)
unique(case)
diabetes_throughout_the_study$developed_diabetes
non_diabetes_throughout_the_study$developed_diabetes
non_diabetes_throughout_the_study$developed_diabetes = rep(0, times = nrow(non_diabetes_throughout_the_study))
non_diabetes_throughout_the_study$developed_diabetes
non_diabetes_throughout_the_study
nrow(non_diabetes_throughout_the_study)
non_diabetes_throughout_the_study
non_diabetes_baseline = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 0)
non_diabetes_followup_1 = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 1)
non_diabetes_followup_2 = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 2)
non_diabetes_followup_3 = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 3)
non_diabetes_followup_4 = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 4)
non_diabetes_followup_5 = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 5)
table(non_diabetes_baseline$discrim_bin)
non_diabetes_baseline_and1 = inner_join(non_diabetes_baseline,
non_diabetes_followup_1,
copy = TRUE,
keep = FALSE,
suffix = c("", "_new"),
by = "HHIDPN")
non_diabetes_baseline_and1_2 = inner_join(non_diabetes_baseline_and1,
non_diabetes_followup_2,
copy = TRUE,
keep = FALSE,
suffix = c("", "_new"),
by = "HHIDPN")
non_diabetes_baseline_and1_2_3 = inner_join(non_diabetes_baseline_and1_2,
non_diabetes_followup_3,
copy = TRUE,
keep = FALSE,
suffix = c("", "_new"),
by = "HHIDPN")
non_diabetes_baseline_and1_2_3_4 = inner_join(non_diabetes_baseline_and1_2_3,
non_diabetes_followup_4,
copy = TRUE,
keep = FALSE,
suffix = c("", "_new"),
by = "HHIDPN")
non_diabetes_throughout_the_study = inner_join(non_diabetes_baseline_and1_2_3_4,
non_diabetes_followup_5,
copy = TRUE,
keep = FALSE,
suffix = c("", "_new"),
by = "HHIDPN")
non_diabetes_throughout_the_study
non_diabetes_baseline
table(non_diabetes_baseline$discrim_bin)
table(non_diabetes_followup_1$discrim_bin)
table(non_diabetes_followup_2$discrim_bin)
table(non_diabetes_followup_3$discrim_bin)
table(non_diabetes_followup_3$discrim_bin)
non_diabetes_followup_3 = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 3)
table(non_diabetes_followup_3$discrim_bin)
table(diabetes_baseline$discrim_bin)
diabetes_baseline = subset(analytical_sample_COX, analytical_sample_COX$diabetes_new == 0 & analytical_sample_COX$start_new == 0)
table(diabetes_baseline$discrim_bin)
diabetes_followup_1
table(diabetes_followup_1$discrim_bin)
table(diabetes_followup_2$discrim_bin)
table(diabetes_followup_3$discrim_bin)
table(case, race)
case = c(diabetes_throughout_the_study$developed_diabetes, non_diabetes_throughout_the_study$developed_diabetes)
unique(case)
diabetes_throughout_the_study$developed_diabetes
non_diabetes_throughout_the_study$developed_diabetes
non_diabetes_throughout_the_study
non_diabetic_participant_char = participant_char_function(data = non_diabetes_throughout_the_study)
non_diabetic_participant_char
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/analytical_sample_vs_entire_sample.R")
chisq.test(case, race)
chisq.test(case, ses)
unique(case)
nrow(non_diabetes_throughout_the_study)
non_diabetes_throughout_the_study
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/participant_char.R")
chisq.test(case, race)
table(case, race)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/analytical_sample_vs_entire_sample.R")
table(case, race)
chisq.test(case, race)
diabetes_throughout_the_study
non_diabetes_baseline_and1_2
non_diabetes_throughout_the_study
chisq.test(data$diabetes_new, data$discrim_bin)
table(data$diabetes_new, data$discrim_bin)
unique(data$diabetes_new)
all = rbind(developed_diabetes_later, non_diabetes)
chisq.test(all$diabetes_new, all$discrim_bin)
unique(all$diabetes_new)
chisq.test(all$diabetes_new, all$discrim_bin)
unique(all$diabetes_new)
table(all$diabetes_new, all$discrim_bin)
all = rbind(developed_diabetes_later, non_diabetes)
group_by(all$start_new)
all = rbind(developed_diabetes_later, non_diabetes)
all %>%
group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
library(dplyr)
all = rbind(developed_diabetes_later, non_diabetes)
all %>%
group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
all = rbind(developed_diabetes_later, non_diabetes)
all %>%
group_by(start_new) %>% unique(all$diabetes_new)
all = rbind(developed_diabetes_later, non_diabetes)
all %>%
group_by(start_new) %>% table(all$diabetes_new, all$discrim_bin)
all$discrim_bin
all$diabetes_new
all %>% group_by(start_new) %>% table(all$diabetes_new, all$discrim_bin)
all %>% group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
all %>% group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
all = as.data.frame(all)
all %>% group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
all %>% group_by(start_new) %>% chisq.test(diabetes_new, discrim_bin)
library(stats)
all %>% group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
all = rbind(developed_diabetes_later, non_diabetes)
all = as.data.frame(all)
all %>% group_by(start_new) %>% chisq.test(all$diabetes_new, all$discrim_bin)
all = rbind(developed_diabetes_later, non_diabetes)
all %>% group_by(start_new) %>% table(all$diabetes_new, all$discrim_bin)
all = rbind(developed_diabetes_later, non_diabetes)
all %>% group_by(start_new) %>% table(all$diabetes_new, all$discrim_bin)
all %>% group_by(start_new) %>% table(diabetes_new, discrim_bin)
all %>% group_by(start_new) %>% table(diabetes_new, discrim_bin)
all %>% group_by(all$start_new) %>% table(all$diabetes_new, all$discrim_bin)
all_timepoint1 = subset(all, all$start_new = 1)
all_timepoint1 = subset(all, all$start_new == 1)
chisq.test(all_timepoint1$diabetes_new, all_timepoint1$discrim_bin)
all_timepoint1 = subset(all, all$start_new == 1)
chisq.test(all_timepoint1$diabetes_new, all_timepoint1$discrim_bin)
table(all_timepoint1$diabetes_new, all_timepoint1$discrim_bin)
all_timepoint0 = subset(all, all$start_new == 0)
chisq.test(all_timepoint0$diabetes_new, all_timepoint0$discrim_bin)
chisq.test(all_timepoint0$diabetes_new, all_timepoint0$discrim_bin)
chisq.test(all_timepoint0$diabetes_new, all_timepoint0$discrim_bin)
developed_diabetes_later_baseline
all_timepoint2 = subset(all, all$start_new == 2)
chisq.test(all_timepoint2$diabetes_new, all_timepoint2$discrim_bin)
table(all_timepoint2$diabetes_new, all_timepoint2$discrim_bin)
all_timepoint3 = subset(all, all$start_new == 3)
chisq.test(all_timepoint3$diabetes_new, all_timepoint3$discrim_bin)
chisq.test(all_timepoint3$diabetes_new, all_timepoint3$discrim_bin)
chisq.test(all_timepoint1$diabetes_new, all_timepoint1$discrim_bin)
table(all_timepoint1$diabetes_new, all_timepoint1$discrim_bin)
all_timepoint0 = subset(all, all$start_new == 0)
chisq.test(all_timepoint0$diabetes_new, all_timepoint0$discrim_bin)
all_timepoint0
all_timepoint0$diabetes_new
chisq.test(all$diabetes_new, all$discrim_bin)
chisq.test(all$diabetes_new, all$race_white)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/summary_score_Bootstrapped_CI.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
all_results = read.csv(paste(OUTPUT_ROOT, "All_clean_data_HRsonly_diabetes_new_bin.csv", sep=""))
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
write.csv(all_discrim_bin_diabetes_thisWAVE_7models, paste(OUTPUT_ROOT, "all_discrim_bin_diabetes_new_bin.csv", sep=""))
all_discrim_bin_diabetes_thisWAVE_7models = Seven_models_drop_baseline(subset_var1 = "NA",
subset_value1 = "NA",
subset_BMI = "NA",
subset_BMI_value  = "NA",
subset_var2 = "NA",
subset_value2 = "NA",
subset_var3= "NA",
subset_value3 = "NA",
subset_name = "ALL",
subset_reason1 = "NA",
subset_reason1_value = "NA",
subset_reason2 = "NA",
subset_reason2_value =  "NA",
subset_reason3 = "NA",
subset_reason3_value = "NA",
HRS2008_data = HRS2008_data,
HRS2010_data = HRS2010_data,
HRS2012_data = HRS2012_data,
HRS2014_data = HRS2014_data,
HRS2016_data = HRS2016_data,
HRS2018_data = HRS2018_data,
exposure = exposure,
outcome = outcome)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Seven_models_drop_baseline.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
all_discrim_bin_diabetes_thisWAVE_7models
all_discrim_bin_diabetes_thisWAVE_7models = Seven_models_drop_baseline(subset_var1 = "NA",
subset_value1 = "NA",
subset_BMI = "NA",
subset_BMI_value  = "NA",
subset_var2 = "NA",
subset_value2 = "NA",
subset_var3= "NA",
subset_value3 = "NA",
subset_name = "ALL",
subset_reason1 = "NA",
subset_reason1_value = "NA",
subset_reason2 = "NA",
subset_reason2_value =  "NA",
subset_reason3 = "NA",
subset_reason3_value = "NA",
HRS2008_data = HRS2008_data,
HRS2010_data = HRS2010_data,
HRS2012_data = HRS2012_data,
HRS2014_data = HRS2014_data,
HRS2016_data = HRS2016_data,
HRS2018_data = HRS2018_data,
exposure = exposure,
outcome = outcome)
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/Seven_models_drop_baseline.R")
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
all_discrim_bin_diabetes_thisWAVE_7models
write.csv(all_discrim_bin_diabetes_thisWAVE_7models, paste(OUTPUT_ROOT, "all_discrim_bin_diabetes_new_bin.csv", sep=""))
all_discrim_bin_diabetes_thisWAVE_7models
source("~/my_docs/proj/Cumulative_effects_HRS/Version_2_analysis/MAIN_marginalised_groups_discrim_bin_diabetesTHIS_WAVE.R")
dataset_noNAs_timepoints
dataset_noNAs_timepoints
dataset = read.csv(file = "/Users/aliya/my_docs/proj/Cumulative_effects_HRS/Results/dataset_noNAs_timepoints_TEST_DELETE_AFTER_debugging_24nov2022.csv")
were_present_at_four_points_ids = c(16602020,
35607020,
78026021,
145768020,
210031010,
210661010,
501617010,
501870010,
502417020,
57714040,
916299010)
ID_4tp = unique(were_present_at_four_points_ids)
dataset_noftp_timepoints<-dataset[!(dataset$HHIDPN %in% ID_4tp),]
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
dataset_ftp_timepoints<-dataset[(dataset$HHIDPN %in% ID_4tp),]
dataset_ftp_timepoints
dataset_ftp_timepoints
dataset_ftp_timepoints_baseline = dataset_ftp_timepoints[(dataset_ftp_timepoints$start_new == 0),]
dataset_ftp_timepoints_baseline
summary(dataset_ftp_timepoints_baseline)
dataset_ftp_timepoints_baseline
